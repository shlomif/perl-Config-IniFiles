# This file was generated by ci-generate / CI::Gen
# (See https://github.com/shlomif/ci-gen-framework )
# Please do not edit directly.


environment:
    install_berry_perl: "cmd /C git clone https://github.com/stevieb9/berrybrew && cd berrybrew/bin && berrybrew.exe install %version% && berrybrew.exe switch %version%"
    install_active_perl: "cmd /C choco install activeperl --version %version%"

    matrix:
        - install_perl: "%install_berry_perl%"
          version: "5.26.0_64"
        - install_perl: "%install_berry_perl%"
          version: "5.24.2_64"
        - install_perl: "%install_berry_perl%"
          version: "5.22.3_64"
        - install_perl: "%install_berry_perl%"
          version: "5.20.3_64"
        - install_perl: "%install_berry_perl%"
          version: "5.18.4_64"
        - install_perl: "%install_berry_perl%"
          version: "5.16.3_64"
        - install_perl: "%install_berry_perl%"
          version: "5.14.4_64"
        - install_perl: "%install_berry_perl%"
          version: "5.12.3_32"
        - install_perl: "%install_active_perl%"
          version: "5.24.1.2402"

install:
    # Install perl
    - cmd: "%install_perl%"
      # Make sure we are in project root
    - cmd: "cd %APPVEYOR_BUILD_FOLDER%"
      # Set path for berrybrew
    - SET PATH=C:\berrybrew\%version%\c\bin;C:\berrybrew\%version%\perl\site\bin;C:\berrybrew\%version%\perl\bin;%PATH%
      # ActivePerl does not include cpanminus
    - cpan      App::cpanminus
    - cpanm -nq PerlIO::utf8_strict
    - cpanm -nq Mixin::Linewise::Readers
    - cpanm -nq Params::Validate
    - cpanm -nq Getopt::Long::Descriptive
    - cpanm -nq Log::Dispatch::Output Software::LicenseUtils Config::MVP::Reader::INI Config::MVP::Assembler Text::Template Data::Section App::Cmd::Tester Log::Dispatchouli MooseX::Types::Perl String::Formatter MooseX::SetOnce CPAN::Uploader Config::MVP::Section Perl::PrereqScanner App::Cmd::Setup Config::MVP::Reader Software::License Config::MVP::Reader::Findable::ByExtension Config::MVP::Reader::Finder Pod::Eventual Mixin::Linewise::Readers Config::MVP::Assembler::WithBundles App::Cmd::Command::version Config::INI::Reader App::Cmd::Tester::CaptureExternal Term::Encoding
    - cpanm -nq Module::Build
    - cpanm -nq Dist::Zilla Pod::Weaver::Section::Support Perl::Critic Perl::Tidy Test::Code::TidyAll
    # Module files for this distribution are not in root
    - cmd: "cd config-inifiles"
    - dzil authordeps | cpanm -nq
    - dzil listdeps   | cpanm -nq
    - cpanm -nq Test::EOL Test::NoTabs Test::Pod Test::Pod::Coverage Pod::Coverage::TrustPod

build: off

test_script:
    - dzil test

shallow_clone: true

matrix:
    allow_failures:
        - install_perl: "%install_berry_perl%"
          version: "5.16.3_64"
        - install_perl: "%install_berry_perl%"
          version: "5.14.4_64"
        - install_perl: "%install_berry_perl%"
          version: "5.12.3_32"
        - install_perl: "%install_active_perl%"
          version: "5.24.1.2402"
